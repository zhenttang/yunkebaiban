# Android åº”ç”¨å¼€å‘è¿è¡ŒæŒ‡å—

## ğŸ“‹ ç›®å½•

- [å‰ç½®è¦æ±‚](#å‰ç½®è¦æ±‚)
- [ç¯å¢ƒé…ç½®](#ç¯å¢ƒé…ç½®)
- [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
- [è¯¦ç»†å¯åŠ¨æµç¨‹](#è¯¦ç»†å¯åŠ¨æµç¨‹)
- [å¼€å‘æ¨¡å¼è¯´æ˜](#å¼€å‘æ¨¡å¼è¯´æ˜)
- [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)
- [è°ƒè¯•æŠ€å·§](#è°ƒè¯•æŠ€å·§)

---

## å‰ç½®è¦æ±‚

### 1. è½¯ä»¶ç¯å¢ƒ

| è½¯ä»¶ | ç‰ˆæœ¬è¦æ±‚ | è¯´æ˜ |
|------|---------|------|
| **Node.js** | < 23.0.0 | æ¨è 18.x æˆ– 20.x LTS ç‰ˆæœ¬ |
| **Yarn** | 4.9.1+ | é¡¹ç›®å·²é…ç½®ï¼Œä¼šè‡ªåŠ¨ä½¿ç”¨ |
| **JDK** | 21 | Android ç¼–è¯‘å¿…éœ€ |
| **Android Studio** | æœ€æ–°ç‰ˆ | æ¨è Hedgehog æˆ–æ›´æ–°ç‰ˆæœ¬ |
| **Android SDK** | API 28+ | é€šè¿‡ Android Studio å®‰è£… |

### 2. ç¡¬ä»¶è¦æ±‚

- **æ¨¡æ‹Ÿå™¨å¼€å‘**ï¼š8GB+ å†…å­˜ï¼Œæ¨è 16GB
- **çœŸæœºå¼€å‘**ï¼šAndroid è®¾å¤‡ + USB æ•°æ®çº¿ï¼Œè®¾å¤‡éœ€å¼€å¯å¼€å‘è€…æ¨¡å¼

---

## ç¯å¢ƒé…ç½®

### 1. æ£€æŸ¥ Node.js å’Œ Yarn

```bash
node --version
# åº”è¾“å‡º: v18.x.x æˆ– v20.x.x

yarn --version
# åº”è¾“å‡º: 4.9.1 æˆ–æ›´é«˜
```

### 2. æ£€æŸ¥ JDK ç‰ˆæœ¬

```bash
java -version
# åº”è¾“å‡º: openjdk version "21.x.x"
```

å¦‚æœç‰ˆæœ¬ä¸å¯¹ï¼Œåœ¨ Android Studio ä¸­é…ç½®ï¼š
- `File` â†’ `Project Structure` â†’ `SDK Location`
- è®¾ç½® `JDK location` ä¸º JDK 21 è·¯å¾„

### 3. é…ç½® Android SDK

åœ¨ Android Studio ä¸­ï¼š
- `Tools` â†’ `SDK Manager`
- ç¡®ä¿å®‰è£…ï¼š
  - Android SDK Platform 31 (API 31) æˆ–æ›´é«˜
  - Android SDK Build-Tools
  - Android Emulator
  - Android SDK Platform-Tools

---

## å¿«é€Ÿå¼€å§‹

### æ–¹æ¡ˆä¸€ï¼šä½¿ç”¨ Android æ¨¡æ‹Ÿå™¨ï¼ˆæ¨èæ–°æ‰‹ï¼‰

```bash
# 1. è¿›å…¥é¡¹ç›®æ ¹ç›®å½•
cd D:\Documents\yunkebaiban\baibanfront

# 2. å®‰è£…ä¾èµ–ï¼ˆé¦–æ¬¡è¿è¡Œï¼‰
yarn install

# 3. å¯åŠ¨å¼€å‘æœåŠ¡å™¨
yarn dev
# é€‰æ‹©: @yunke/android

# 4. ç­‰å¾…ç¼–è¯‘å®Œæˆï¼ˆ5-15åˆ†é’Ÿï¼‰
# çœ‹åˆ°: Compiled successfully

# 5. æ‰“å¼€æ–°ç»ˆç«¯ï¼ŒåŒæ­¥åˆ° Android é¡¹ç›®ï¼ˆæ¨¡æ‹Ÿå™¨ï¼‰
cd D:\Documents\yunkebaiban\baibanfront
yarn workspace @yunke/android sync:dev

# 6. æ‰“å¼€ Android Studio
yarn workspace @yunke/android studio

# 7. åœ¨ Android Studio ä¸­
#    - åˆ›å»ºæ¨¡æ‹Ÿå™¨: Tools â†’ Device Manager â†’ Create Device
#    - æ¨èé…ç½®: Pixel 5, API 31, arm64-v8a
#    - å¯åŠ¨æ¨¡æ‹Ÿå™¨
#    - ç‚¹å‡» Run â–¶ï¸
```

### æ–¹æ¡ˆäºŒï¼šä½¿ç”¨çœŸå®æ‰‹æœº

```bash
# å‰ç½®æ­¥éª¤ï¼š
# 1. æ‰‹æœºå’Œç”µè„‘è¿æ¥åŒä¸€ WiFi
# 2. æ‰‹æœºå¼€å¯å¼€å‘è€…æ¨¡å¼å’Œ USB è°ƒè¯•
# 3. ç”¨ USB æ•°æ®çº¿è¿æ¥æ‰‹æœº

# 1. æŸ¥çœ‹ç”µè„‘ IP åœ°å€
ipconfig
# æ‰¾åˆ° IPv4 åœ°å€ï¼Œä¾‹å¦‚: 192.168.2.4

# 2. ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼ˆå·²ç»åšå¥½ï¼Œè·³è¿‡æ­¤æ­¥éª¤ï¼‰
# packages/frontend/apps/android/package.json
# "sync:dev": "CAP_SERVER_URL=http://192.168.2.4:8082 cap sync"

# 3. å¯åŠ¨å¼€å‘æœåŠ¡å™¨
cd D:\Documents\yunkebaiban\baibanfront
yarn dev
# é€‰æ‹©: @yunke/android

# 4. åŒæ­¥åˆ° Android é¡¹ç›®
yarn workspace @yunke/android sync:dev

# 5. æ‰“å¼€ Android Studio å¹¶è¿è¡Œ
yarn workspace @yunke/android studio
# åœ¨è®¾å¤‡åˆ—è¡¨ä¸­é€‰æ‹©ä½ çš„æ‰‹æœº
# ç‚¹å‡» Run â–¶ï¸
```

---

## è¯¦ç»†å¯åŠ¨æµç¨‹

### é˜¶æ®µä¸€ï¼šå‡†å¤‡å·¥ä½œ

#### 1.1 å®‰è£…é¡¹ç›®ä¾èµ–

```bash
cd D:\Documents\yunkebaiban\baibanfront
yarn install
```

**é¦–æ¬¡å®‰è£…æ—¶é—´**ï¼š5-15 åˆ†é’Ÿï¼Œå–å†³äºç½‘ç»œé€Ÿåº¦

**å¯èƒ½çš„é—®é¢˜**ï¼š
- å¦‚æœä¸‹è½½æ…¢ï¼Œé…ç½®å›½å†…é•œåƒï¼š
  ```bash
  yarn config set registry https://registry.npmmirror.com
  ```

#### 1.2 ç¡®è®¤ IP åœ°å€é…ç½®

**ä½¿ç”¨æ¨¡æ‹Ÿå™¨**ï¼š
- æ— éœ€ä¿®æ”¹é…ç½®
- æ¨¡æ‹Ÿå™¨ä½¿ç”¨ `10.0.2.2` è®¿é—®å®¿ä¸»æœº localhost

**ä½¿ç”¨çœŸæœº**ï¼š
```bash
# æŸ¥çœ‹ç”µè„‘ IP
ipconfig
# è®°ä¸‹ IPv4 åœ°å€ï¼Œä¾‹å¦‚: 192.168.2.4

# ä¿®æ”¹é…ç½®æ–‡ä»¶
# packages/frontend/apps/android/package.json
"sync:dev": "CAP_SERVER_URL=http://[ä½ çš„IP]:8082 cap sync"

# packages/frontend/apps/android/src/app.tsx
const ANDROID_SERVER_HOST = '[ä½ çš„IP]:8082';
```

### é˜¶æ®µäºŒï¼šå¯åŠ¨å¼€å‘æœåŠ¡å™¨

#### 2.1 ä½¿ç”¨äº¤äº’å¼å‘½ä»¤ï¼ˆæ¨èï¼‰

```bash
cd D:\Documents\yunkebaiban\baibanfront
yarn dev
```

ä¼šå‡ºç°é€‰æ‹©èœå•ï¼š
```
? æ‚¨æƒ³è¦å¼€å‘å“ªä¸ªåŒ…ï¼Ÿ (Use arrow keys)
> @affine/web
  @affine/server
  @affine/electron
  @affine/electron-renderer
  @affine/mobile
  @affine/ios
  @yunke/android          â† ç”¨æ–¹å‘é”®é€‰æ‹©è¿™ä¸ª
  @affine/admin
```

#### 2.2 ç¼–è¯‘è¿‡ç¨‹

```
[bundle] Starting dev server for @yunke/android...
<i> [webpack-dev-server] Project is running at:
<i> [webpack-dev-server] Loopback: http://localhost:8082/
<i> [webpack-dev-server] On Your Network: http://192.168.2.4:8082/

37% building...  â† æ­£åœ¨ç¼–è¯‘
```

**ç¼–è¯‘æ—¶é—´**ï¼šé¦–æ¬¡ 5-15 åˆ†é’Ÿï¼Œåç»­ 30 ç§’ - 2 åˆ†é’Ÿ

**ç¼–è¯‘å®Œæˆæ ‡å¿—**ï¼š
```
<i> [webpack-dev-server] Compiled successfully in XXXXms
```

**é‡è¦**ï¼šä¿æŒè¿™ä¸ªç»ˆç«¯è¿è¡Œï¼Œä¸è¦å…³é—­ï¼

### é˜¶æ®µä¸‰ï¼šåŒæ­¥åˆ° Android é¡¹ç›®

#### 3.1 æ‰“å¼€æ–°ç»ˆç«¯

ä¿æŒå¼€å‘æœåŠ¡å™¨è¿è¡Œï¼Œæ‰“å¼€æ–°çš„ CMD æˆ– PowerShell çª—å£ã€‚

#### 3.2 æ‰§è¡ŒåŒæ­¥å‘½ä»¤

```bash
cd D:\Documents\yunkebaiban\baibanfront
yarn workspace @yunke/android sync:dev
```

**åŒæ­¥è¿‡ç¨‹è¾“å‡º**ï¼š
```
âˆš Copying web assets from dist to App\app\src\main\assets\public in 188.13ms
âˆš Creating capacitor.config.json in App\app\src\main\assets in 908.50Î¼s
âˆš copy android in 206.98ms
âˆš Updating Android plugins in 2.85ms
[info] Found 4 Capacitor plugins for android:
       @capacitor/app@7.0.1
       @capacitor/keyboard@7.0.1
       @capacitor/status-bar@7.0.1
       @capgo/inappbrowser@7.12.1
âˆš update android in 58.19ms
[info] Sync finished in 0.312s
```

### é˜¶æ®µå››ï¼šè¿è¡Œ Android åº”ç”¨

#### 4.1 æ‰“å¼€ Android Studio

```bash
# æ–¹å¼1: ä½¿ç”¨å‘½ä»¤
yarn workspace @yunke/android studio

# æ–¹å¼2: æ‰‹åŠ¨æ‰“å¼€
# ç”¨æ–‡ä»¶ç®¡ç†å™¨æ‰“å¼€:
# D:\Documents\yunkebaiban\baibanfront\packages\frontend\apps\android\App
# åœ¨ Android Studio ä¸­: File â†’ Open â†’ é€‰æ‹© App ç›®å½•
```

#### 4.2 Gradle åŒæ­¥

**é¦–æ¬¡æ‰“å¼€é¡¹ç›®**ï¼š
- Android Studio ä¼šè‡ªåŠ¨å¼€å§‹ Gradle åŒæ­¥
- åº•éƒ¨çŠ¶æ€æ æ˜¾ç¤ºè¿›åº¦
- é¦–æ¬¡åŒæ­¥æ—¶é—´ï¼š10-30 åˆ†é’Ÿï¼ˆä¸‹è½½ä¾èµ–ï¼‰
- åç»­åŒæ­¥æ—¶é—´ï¼š1-3 åˆ†é’Ÿ

**ç­‰å¾…æ˜¾ç¤º**ï¼š
```
BUILD SUCCESSFUL
```

#### 4.3 åˆ›å»º/å¯åŠ¨æ¨¡æ‹Ÿå™¨ï¼ˆå¦‚æœä½¿ç”¨æ¨¡æ‹Ÿå™¨ï¼‰

**åˆ›å»ºæ¨¡æ‹Ÿå™¨**ï¼š
1. ç‚¹å‡»é¡¶éƒ¨å·¥å…·æ çš„è®¾å¤‡å›¾æ ‡ ğŸ“±
2. æˆ– `Tools` â†’ `Device Manager`
3. ç‚¹å‡» `Create Device`
4. é€‰æ‹©è®¾å¤‡ï¼š
   - ç±»åˆ«ï¼šPhone
   - è®¾å¤‡ï¼š**Pixel 5** æˆ– **Pixel 6**
5. é€‰æ‹©ç³»ç»Ÿé•œåƒï¼š
   - Release Nameï¼š**S (API 31)** æˆ–æ›´é«˜
   - ABIï¼š**arm64-v8a**
   - å¦‚æœæœªä¸‹è½½ï¼Œç‚¹å‡» Download
6. é…ç½®å®Œæˆï¼Œç‚¹å‡» Finish

**å¯åŠ¨æ¨¡æ‹Ÿå™¨**ï¼š
- åœ¨ Device Manager ä¸­ç‚¹å‡»ç»¿è‰² â–¶ï¸ æŒ‰é’®
- ç­‰å¾…æ¨¡æ‹Ÿå™¨å¯åŠ¨å®Œæˆï¼ˆé¦–æ¬¡è¾ƒæ…¢ï¼‰

#### 4.4 è¿æ¥çœŸå®æ‰‹æœºï¼ˆå¦‚æœä½¿ç”¨çœŸæœºï¼‰

**æ‰‹æœºé…ç½®**ï¼š
1. å¼€å¯å¼€å‘è€…æ¨¡å¼ï¼š
   - è®¾ç½® â†’ å…³äºæ‰‹æœº â†’ è¿ç»­ç‚¹å‡»ç‰ˆæœ¬å· 7 æ¬¡
2. å¼€å¯ USB è°ƒè¯•ï¼š
   - è®¾ç½® â†’ å¼€å‘è€…é€‰é¡¹ â†’ USB è°ƒè¯•
3. è¿æ¥ USB æ•°æ®çº¿
4. æ‰‹æœºå¼¹å‡ºæˆæƒæç¤ºï¼Œç‚¹å‡»"å…è®¸"

**éªŒè¯è¿æ¥**ï¼š
```bash
# åœ¨ç»ˆç«¯ä¸­æ‰§è¡Œ
adb devices
# åº”è¯¥çœ‹åˆ°ä½ çš„è®¾å¤‡
```

#### 4.5 è¿è¡Œåº”ç”¨

1. åœ¨ Android Studio é¡¶éƒ¨é€‰æ‹©ç›®æ ‡è®¾å¤‡
   - æ¨¡æ‹Ÿå™¨ï¼šé€‰æ‹©åˆšåˆ›å»ºçš„æ¨¡æ‹Ÿå™¨
   - çœŸæœºï¼šé€‰æ‹©ä½ çš„æ‰‹æœºå‹å·

2. ç‚¹å‡»ç»¿è‰²çš„ Run æŒ‰é’® â–¶ï¸
   - æˆ–æŒ‰å¿«æ·é”®ï¼š`Shift + F10`

3. ç­‰å¾…åº”ç”¨å®‰è£…å¹¶å¯åŠ¨
   - é¦–æ¬¡å®‰è£…ï¼š1-3 åˆ†é’Ÿ
   - åç»­å®‰è£…ï¼š30 ç§’ - 1 åˆ†é’Ÿ

---

## å¼€å‘æ¨¡å¼è¯´æ˜

### sync:devï¼ˆå¼€å‘æ¨¡å¼ï¼‰vs syncï¼ˆç”Ÿäº§æ¨¡å¼ï¼‰

#### å¼€å‘æ¨¡å¼ï¼š`yarn workspace @yunke/android sync:dev`

**ç‰¹ç‚¹**ï¼š
- âœ… è¿æ¥åˆ°æœ¬åœ°å¼€å‘æœåŠ¡å™¨
- âœ… æ”¯æŒçƒ­é‡è½½ï¼ˆä¿®æ”¹ä»£ç è‡ªåŠ¨åˆ·æ–°ï¼‰
- âœ… å¯ä»¥ä½¿ç”¨ Chrome DevTools è°ƒè¯•
- âš ï¸ éœ€è¦ä¿æŒå¼€å‘æœåŠ¡å™¨è¿è¡Œ
- âš ï¸ æ‰‹æœº/æ¨¡æ‹Ÿå™¨éœ€è¦ç½‘ç»œè¿æ¥

**é€‚ç”¨åœºæ™¯**ï¼šæ—¥å¸¸å¼€å‘è°ƒè¯•

**é…ç½®**ï¼š
```json
// package.json
"sync:dev": "CAP_SERVER_URL=http://192.168.2.4:8082 cap sync"
```

#### ç”Ÿäº§æ¨¡å¼ï¼š`yarn workspace @yunke/android sync`

**ç‰¹ç‚¹**ï¼š
- âœ… Web èµ„æºå®Œæ•´æ‰“åŒ…åˆ° APK
- âœ… ç¦»çº¿å¯ç”¨
- âœ… æ€§èƒ½æ›´æ¥è¿‘çœŸå®ç¯å¢ƒ
- âš ï¸ æ¯æ¬¡ä¿®æ”¹éƒ½éœ€è¦é‡æ–°ç¼–è¯‘å’ŒåŒæ­¥
- âš ï¸ è°ƒè¯•ç›¸å¯¹å›°éš¾

**é€‚ç”¨åœºæ™¯**ï¼šæµ‹è¯•æœ€ç»ˆç‰ˆæœ¬ã€æ‰“åŒ…å‘å¸ƒ

**ä½¿ç”¨æ­¥éª¤**ï¼š
```bash
# 1. æ„å»ºç”Ÿäº§ç‰ˆæœ¬
cd D:\Documents\yunkebaiban\baibanfront
yarn workspace @yunke/android build

# 2. åŒæ­¥ï¼ˆä¸è¿æ¥å¼€å‘æœåŠ¡å™¨ï¼‰
yarn workspace @yunke/android sync

# 3. åœ¨ Android Studio ä¸­è¿è¡Œ
```

### å¼€å‘å¾ªç¯

**æ­£å¸¸å¼€å‘æµç¨‹**ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. å¯åŠ¨å¼€å‘æœåŠ¡å™¨ (yarn dev)            â”‚
â”‚    ä¿æŒè¿è¡Œï¼Œä¸å…³é—­                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. é¦–æ¬¡åŒæ­¥ (yarn workspace sync:dev)   â”‚
â”‚    åªéœ€æ‰§è¡Œä¸€æ¬¡                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. è¿è¡Œ Android åº”ç”¨                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. ä¿®æ”¹ä»£ç ï¼ˆå‰ç«¯ä»£ç ï¼‰                  â”‚
â”‚    â”œâ”€ ä¿å­˜æ–‡ä»¶                           â”‚
â”‚    â”œâ”€ å¼€å‘æœåŠ¡å™¨è‡ªåŠ¨é‡æ–°ç¼–è¯‘             â”‚
â”‚    â””â”€ Android åº”ç”¨è‡ªåŠ¨åˆ·æ–°               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â†“
         é‡å¤æ­¥éª¤ 4
```

**å¦‚æœä¿®æ”¹äº† Android åŸç”Ÿä»£ç **ï¼š
- éœ€è¦åœ¨ Android Studio ä¸­é‡æ–° Build & Run

**å¦‚æœä¿®æ”¹äº† Capacitor é…ç½®**ï¼š
- éœ€è¦é‡æ–°æ‰§è¡Œ `yarn workspace @yunke/android sync:dev`

---

## å¸¸è§é—®é¢˜

### 1. å‘½ä»¤æ‰¾ä¸åˆ°

**é—®é¢˜**ï¼š
```
'affine' ä¸æ˜¯å†…éƒ¨æˆ–å¤–éƒ¨å‘½ä»¤
```

**åŸå› **ï¼š
- ä¾èµ–æœªå®‰è£…
- åœ¨é”™è¯¯çš„ç›®å½•è¿è¡Œ

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# å›åˆ°æ ¹ç›®å½•
cd D:\Documents\yunkebaiban\baibanfront

# é‡æ–°å®‰è£…ä¾èµ–
yarn install

# ä½¿ç”¨æ ¹ç›®å½•å‘½ä»¤
yarn dev
```

### 2. ç«¯å£è¢«å ç”¨

**é—®é¢˜**ï¼š
```
Error: listen EADDRINUSE: address already in use :::8082
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# Windows: æŸ¥æ‰¾å ç”¨ 8082 ç«¯å£çš„è¿›ç¨‹
netstat -ano | findstr :8082

# æ€æ­»è¿›ç¨‹ï¼ˆPID æ˜¯ä¸Šä¸€æ­¥è¾“å‡ºçš„æ•°å­—ï¼‰
taskkill /PID [PID] /F

# æˆ–è€…ä¿®æ”¹ç«¯å£ï¼ˆåœ¨ bundle.ts ä¸­ä¿®æ”¹ï¼‰
```

### 3. Gradle åŒæ­¥å¤±è´¥

**é—®é¢˜**ï¼š
```
BUILD FAILED
Could not resolve dependencies
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# 1. æ£€æŸ¥ç½‘ç»œè¿æ¥

# 2. é…ç½® Gradle é•œåƒï¼ˆåˆ›å»º/ç¼–è¾‘æ–‡ä»¶ï¼‰
# C:\Users\[ç”¨æˆ·å]\.gradle\init.gradle
allprojects {
    repositories {
        maven { url 'https://maven.aliyun.com/repository/google' }
        maven { url 'https://maven.aliyun.com/repository/public' }
        maven { url 'https://maven.aliyun.com/repository/gradle-plugin' }
    }
}

# 3. åœ¨ Android Studio ä¸­
# File â†’ Invalidate Caches â†’ Invalidate and Restart
```

### 4. åº”ç”¨ç™½å±

**å¯èƒ½åŸå›  Aï¼šå¼€å‘æœåŠ¡å™¨æœªè¿è¡Œ**

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# ç¡®ä¿å¼€å‘æœåŠ¡å™¨æ­£åœ¨è¿è¡Œ
cd D:\Documents\yunkebaiban\baibanfront
yarn dev
```

**å¯èƒ½åŸå›  Bï¼šç½‘ç»œè¿æ¥é—®é¢˜**

**æ£€æŸ¥æ­¥éª¤**ï¼š
```bash
# 1. æŸ¥çœ‹ Android Studio Logcat
# æœç´¢: "Loading app at"
# åº”è¯¥çœ‹åˆ°: Loading app at http://192.168.2.4:8082

# 2. åœ¨æ‰‹æœºæµè§ˆå™¨æµ‹è¯•
# æ‰“å¼€: http://192.168.2.4:8082
# åº”è¯¥èƒ½çœ‹åˆ°ç½‘é¡µ

# 3. ç¡®ä¿æ‰‹æœºå’Œç”µè„‘åœ¨åŒä¸€ç½‘ç»œ
```

**å¯èƒ½åŸå›  Cï¼šIP åœ°å€é…ç½®é”™è¯¯**

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# 1. é‡æ–°è·å– IP
ipconfig

# 2. ä¿®æ”¹é…ç½®
# packages/frontend/apps/android/package.json
"sync:dev": "CAP_SERVER_URL=http://[æ­£ç¡®çš„IP]:8082 cap sync"

# 3. é‡æ–°åŒæ­¥
yarn workspace @yunke/android sync:dev

# 4. é‡æ–°è¿è¡Œåº”ç”¨
```

### 5. JDK ç‰ˆæœ¬é—®é¢˜

**é—®é¢˜**ï¼š
```
Unsupported class file major version 65
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# 1. å®‰è£… JDK 21
# ä¸‹è½½åœ°å€: https://adoptium.net/

# 2. åœ¨ Android Studio ä¸­é…ç½®
# File â†’ Project Structure â†’ SDK Location
# JDK location: é€‰æ‹© JDK 21 è·¯å¾„

# 3. é‡å¯ Android Studio
```

### 6. æ‰‹æœºæ— æ³•è¿æ¥

**é—®é¢˜**ï¼š
```
adb devices
List of devices attached
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# 1. é‡æ–°æ’æ‹” USB çº¿

# 2. é‡å¯ adb
adb kill-server
adb start-server
adb devices

# 3. ç¡®è®¤æ‰‹æœº USB è°ƒè¯•å·²å¼€å¯

# 4. æ›´æ¢ USB çº¿æˆ–æ¥å£

# 5. å®‰è£…æ‰‹æœºé©±åŠ¨ï¼ˆæŸäº›å“ç‰Œéœ€è¦ï¼‰
```

---

## è°ƒè¯•æŠ€å·§

### 1. Chrome DevTools è°ƒè¯•

**WebView è°ƒè¯•**ï¼š

```bash
# 1. ç¡®ä¿åº”ç”¨æ­£åœ¨è¿è¡Œ

# 2. Chrome æµè§ˆå™¨æ‰“å¼€
chrome://inspect

# 3. åœ¨ "Remote Target" éƒ¨åˆ†æ‰¾åˆ°åº”ç”¨
# ç‚¹å‡» "inspect"

# 4. å¯ä»¥ï¼š
#    - æŸ¥çœ‹ Console æ—¥å¿—
#    - æ£€æŸ¥ Network è¯·æ±‚
#    - è°ƒè¯• JavaScript
#    - æŸ¥çœ‹ DOM ç»“æ„
```

### 2. Android Studio Logcat

**æŸ¥çœ‹åº”ç”¨æ—¥å¿—**ï¼š

```bash
# 1. åœ¨ Android Studio åº•éƒ¨ç‚¹å‡» Logcat

# 2. è¿‡æ»¤å™¨è®¾ç½®
#    - åŒ…åï¼šapp.affine.pro
#    - Tagï¼šé€‰æ‹©å…³æ³¨çš„ Tag

# 3. å¸¸ç”¨ Tagï¼š
#    - AffineApp: åº”ç”¨ä¸»è¦æ—¥å¿—
#    - chromium: WebView å†…æ ¸æ—¥å¿—
#    - Capacitor: Capacitor æ’ä»¶æ—¥å¿—
```

### 3. é‡æ–°åŠ è½½åº”ç”¨

**åœ¨åº”ç”¨ä¸­åˆ·æ–°**ï¼š

æ–¹æ³• 1ï¼šä¸‹æ‹‰åˆ·æ–°ï¼ˆå¦‚æœåº”ç”¨æ”¯æŒï¼‰

æ–¹æ³• 2ï¼šä½¿ç”¨ Chrome DevTools
- æ‰“å¼€ `chrome://inspect`
- åœ¨ DevTools ä¸­æŒ‰ `Ctrl + R` æˆ– `Cmd + R`

æ–¹æ³• 3ï¼šé‡å¯åº”ç”¨
- Android Studio ä¸­ç‚¹å‡» Stop â¹ï¸
- å†ç‚¹å‡» Run â–¶ï¸

### 4. æ¸…é™¤åº”ç”¨æ•°æ®

**å®Œå…¨é‡ç½®åº”ç”¨**ï¼š

```bash
# æ–¹æ³• 1: åœ¨æ‰‹æœºè®¾ç½®ä¸­
# è®¾ç½® â†’ åº”ç”¨ â†’ äº‘ç§‘ â†’ å­˜å‚¨ â†’ æ¸…é™¤æ•°æ®

# æ–¹æ³• 2: ä½¿ç”¨ adb
adb shell pm clear app.affine.pro

# æ–¹æ³• 3: å¸è½½é‡è£…
# Android Studio ä¸­å¸è½½åº”ç”¨
# é‡æ–°è¿è¡Œ
```

### 5. æ€§èƒ½åˆ†æ

**æ£€æŸ¥æ€§èƒ½é—®é¢˜**ï¼š

```bash
# 1. åœ¨ Android Studio ä¸­
# View â†’ Tool Windows â†’ Profiler

# 2. é€‰æ‹©åº”ç”¨è¿›ç¨‹

# 3. å¯ä»¥æŸ¥çœ‹ï¼š
#    - CPU ä½¿ç”¨ç‡
#    - å†…å­˜ä½¿ç”¨
#    - ç½‘ç»œè¯·æ±‚
```

### 6. å¯¼å‡º APK

**ç”Ÿæˆè°ƒè¯•ç‰ˆ APK**ï¼š

```bash
# 1. åœ¨ Android Studio ä¸­
# Build â†’ Build Bundle(s) / APK(s) â†’ Build APK(s)

# 2. APK ä½ç½®
# App/app/build/outputs/apk/debug/app-debug.apk

# 3. å®‰è£…åˆ°å…¶ä»–è®¾å¤‡
adb install app-debug.apk
```

---

## é™„å½•

### é¡¹ç›®ç»“æ„

```
baibanfront/
â”œâ”€â”€ packages/
â”‚   â””â”€â”€ frontend/
â”‚       â””â”€â”€ apps/
â”‚           â””â”€â”€ android/           # Android åº”ç”¨
â”‚               â”œâ”€â”€ App/           # Android åŸç”Ÿé¡¹ç›®
â”‚               â”‚   â”œâ”€â”€ app/       # åº”ç”¨ä¸»æ¨¡å—
â”‚               â”‚   â””â”€â”€ build.gradle
â”‚               â”œâ”€â”€ src/           # Web å‰ç«¯ä»£ç 
â”‚               â”‚   â”œâ”€â”€ app.tsx    # ä¸»åº”ç”¨ç»„ä»¶
â”‚               â”‚   â”œâ”€â”€ index.tsx  # å…¥å£æ–‡ä»¶
â”‚               â”‚   â””â”€â”€ plugins/   # Capacitor æ’ä»¶
â”‚               â”œâ”€â”€ dist/          # ç¼–è¯‘è¾“å‡ºï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰
â”‚               â”œâ”€â”€ capacitor.config.ts  # Capacitor é…ç½®
â”‚               â””â”€â”€ package.json   # åŒ…é…ç½®
â”œâ”€â”€ tools/
â”‚   â””â”€â”€ cli/
â”‚       â””â”€â”€ src/
â”‚           â”œâ”€â”€ dev.ts            # å¼€å‘å‘½ä»¤
â”‚           â””â”€â”€ bundle.ts         # æ‰“åŒ…å‘½ä»¤
â””â”€â”€ package.json                  # æ ¹é…ç½®
```

### å¿«é€Ÿå‘½ä»¤å‚è€ƒ

```bash
# === æ ¹ç›®å½•å‘½ä»¤ ===
cd D:\Documents\yunkebaiban\baibanfront

# å®‰è£…ä¾èµ–
yarn install

# å¯åŠ¨å¼€å‘ï¼ˆäº¤äº’å¼é€‰æ‹©ï¼‰
yarn dev

# ç±»å‹æ£€æŸ¥
yarn typecheck

# ä»£ç æ£€æŸ¥
yarn lint

# === Android åº”ç”¨å‘½ä»¤ ===

# å¼€å‘æ¨¡å¼æ„å»º
yarn workspace @yunke/android dev

# ç”Ÿäº§æ¨¡å¼æ„å»º
yarn workspace @yunke/android build

# åŒæ­¥ï¼ˆå¼€å‘æ¨¡å¼ï¼‰
yarn workspace @yunke/android sync:dev

# åŒæ­¥ï¼ˆç”Ÿäº§æ¨¡å¼ï¼‰
yarn workspace @yunke/android sync

# æ‰“å¼€ Android Studio
yarn workspace @yunke/android studio

# === adb å‘½ä»¤ ===

# æŸ¥çœ‹è¿æ¥çš„è®¾å¤‡
adb devices

# æŸ¥çœ‹åº”ç”¨æ—¥å¿—
adb logcat | grep "app.affine.pro"

# å®‰è£… APK
adb install app-debug.apk

# å¸è½½åº”ç”¨
adb uninstall app.affine.pro

# æ¸…é™¤åº”ç”¨æ•°æ®
adb shell pm clear app.affine.pro
```

### ç›¸å…³èµ„æº

- **Capacitor å®˜æ–¹æ–‡æ¡£**: https://capacitorjs.com/docs
- **Android å¼€å‘æ–‡æ¡£**: https://developer.android.com/
- **React æ–‡æ¡£**: https://react.dev/
- **é¡¹ç›®ä»“åº“**: (ä½ çš„ä»“åº“åœ°å€)

---

## è”ç³»ä¸æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·ï¼š
1. æŸ¥çœ‹æœ¬æ–‡æ¡£çš„[å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)éƒ¨åˆ†
2. æŸ¥çœ‹é¡¹ç›® Issues
3. è”ç³»å¼€å‘å›¢é˜Ÿ

---

**æœ€åæ›´æ–°**: 2025-10-15
**æ–‡æ¡£ç‰ˆæœ¬**: 1.0.0

