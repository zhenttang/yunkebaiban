# 标签列表视图（功能 + 实现说明）

> 关联上级：`工作空间/页面组织与导航/标签与集合导航.md`  
> 相关代码位置：
> - 标签列表组件：`packages/frontend/core/src/components/page-list/tags/*`
> - 列表渲染器：`page-list/page-group.tsx` 内 `TagListItemRenderer`

---

## 1. 标签列表展示

### 1.1 数据结构

- 每个标签（TagMeta）通常包含：
  - `id`：标签唯一标识；
  - `name`：标签名称；
  - `color`：标签颜色（用于 UI 标识）；
  - （可选）`description`：标签描述；
  - （可选）`pageCount`：绑定页面数量（可由后端计算）。

### 1.2 列表渲染器

- 在 `page-group.tsx` 中，`TagListItemRenderer` 将标签元信息转换为列表项：

```tsx
export const TagListItemRenderer = memo(function TagListItemRenderer(
  item: ListItem
) {
  const props = useAtomValue(listsPropsAtom);
  const { selectionActive } = useAtomValue(selectionStateAtom);
  const tag = item as TagMeta;
  return (
    <TagListItem
      {...tagMetaToListItemProp(tag, {
        ...props,
        selectable: !!selectionActive,
      })}
    />
  );
});
```

- `tagMetaToListItemProp` 将标签元数据映射为组件 `TagListItem` 所需的属性：

```ts
const itemProps: TagListItemProps = {
  tagId: item.id,
  title: item.name,
  to: props.rowAsLink && !props.selectable ? `/tag/${item.id}` : undefined,
  onClick: toggleSelection,
  color: item.color,
  operations: props.operationsRenderer?.(item),
  selectable: props.selectable,
  selected: props.selectedIds?.includes(item.id),
  onSelectedChange: toggleSelection,
  draggable: props.draggable,
};
```

- 展示内容：
  - 标签名（title）；
  - 标签颜色标识（color）；
  - 可选：附加操作按钮等。

---

## 2. 标签列表交互

### 2.1 点击行为与过滤

- 当 `rowAsLink` 为 `true` 且不处于多选模式时：
  - 点击标签行会跳转到 `/workspace/:workspaceId/tag/:tagId` 或类似路径；
  - 在该路由下按标签过滤页面列表。
- 在某些视图中，可以只在当前列表内过滤：
  - 例如“全部页面”列表中选中某标签后，只显示带该标签的页面；
  - 由列表组件的 `filters` 或外层状态控制。

### 2.2 多选与批量操作

- 与页面列表类似，标签列表也支持多选模式（视配置）：
  - 启用选择模式后，点击标签不再跳转，而是切换选择状态；
  - 可对选中的标签执行批量操作（如批量删除、合并标签等，视实现）。

### 2.3 拖拽与排序（可选）

- `TagListItemProps` 中包含 `draggable` 与 `onSelectedChange` 等属性：
  - 若启用拖拽，则可以调整标签顺序；
  - 实际排序结果可以由后端或本地存储决定。

---

## 3. 标签搜索与快速定位（设计）

### 3.1 搜索能力

- 在标签列表上方提供搜索框：
  - 按名称模糊搜索标签；
  - 实时过滤列表；
  - 支持大小写不敏感匹配。

### 3.2 快速跳转与筛选

- 搜索结果中点击某标签，即可：
  - 跳转到该标签对应的页面列表视图；
  - 或在当前视图中应用标签过滤条件。

> 目前代码中未显式看到标签搜索实现，以上为功能设计说明，具体可参照 page-list 现有筛选和搜索模式来实现。 
