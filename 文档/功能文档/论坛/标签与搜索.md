# 标签与搜索（功能 + 实现说明）

> 关联上级：`文档/功能文档/forum.md`  
> 主要相关代码：
> - 标签帖子列表：`packages/frontend/core/src/desktop/pages/workspace/forum/tag-posts/index.tsx`
> - 搜索结果页：`packages/frontend/core/src/desktop/pages/workspace/forum/search-result/index.tsx`
> - API：`packages/frontend/core/src/desktop/pages/workspace/forum/forum-api.ts`
> - 类型定义：`packages/frontend/core/src/desktop/pages/workspace/forum/types.ts`

---

## 1. 标签视图（/forum/tags/:tagId）

> 细节见子文档：`论坛/标签与搜索/标签浏览与过滤.md`

- 功能视角：
  - 展示某个标签下的帖子列表；
  - 显示标签名称和相关统计信息（例如热门标签列表中推导出的名称）；
  - 支持分页浏览帖子，并从列表点击进入帖子详情。

- 实现要点：
  - 使用 `useParams` 获取 `tagId`；
  - 并行调用 `getPostsByTag(tagId, page, size)` 与 `getPopularTags()`；
  - 通过 `TagDTO` 列表查找当前标签名称；
  - 使用 `PaginatedResponse<PostDTO>` 渲染帖子列表和分页控件。

---

## 2. 搜索结果视图（/forum/search）

> 细节见子文档：`论坛/标签与搜索/搜索结果展示.md`

- 功能视角：
  - 提供统一的论坛搜索入口；
  - 支持按关键字搜索帖子与板块；
  - 展示搜索结果摘要，并高亮匹配内容；
  - 提供点击跳转到对应帖子详情或板块详情。

- 实现要点：
  - 使用 `useSearchParams` 获取 `keyword` 参数；
  - 调用 `quickSearch(keyword, 'ALL')` 获取 `SearchResultDTO[]`；
  - 在前端按 `type` 将结果拆为“帖子结果”和“板块结果”两组；
  - 使用 `dangerouslySetInnerHTML` 渲染后端提供的高亮 HTML 片段（`highlight` 字段），或退回到简要 `content` 截断展示；
  - 为每条结果构造跳转路径：
    - 帖子：`/forum/{forumId}/post/{id}`；
    - 板块：`/forum/{forumId或id}`。

> 标签视图与搜索结果视图共同构成了论坛的“发现与筛选”能力：前者提供按标签主题聚合内容，后者提供跨板块的关键字检索。 
